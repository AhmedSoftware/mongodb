Import("env")
Import("has_option")

if has_option("wiredtiger"):
    env.Library(
	target= 'storage_wiredtiger',
	source= [
	    'wiredtiger_collection_catalog_entry.cpp',
	    'wiredtiger_database_catalog_entry.cpp',
	    'wiredtiger_engine.cpp',
	    'wiredtiger_global_options.cpp',
	    'wiredtiger_index.cpp',
	    'wiredtiger_options_init.cpp',
	    'wiredtiger_init.cpp',
	    'wiredtiger_record_store.cpp',
	    'wiredtiger_recovery_unit.cpp',
	    ],
	LIBDEPS= [
	    '$BUILD_DIR/mongo/bson',
	    '$BUILD_DIR/mongo/db/catalog/collection_options',
	    '$BUILD_DIR/mongo/foundation',
	    ],
	SYSLIBDEPS=["wiredtiger"]
	)

    env.CppUnitTest(
	   target='storage_wiredtiger_index_test',
	   source=['wiredtiger_index_test.cpp',
	           ],
	   LIBDEPS=[
	        'storage_wiredtiger',
	        "$BUILD_DIR/mongo/coredb",
	        "$BUILD_DIR/mongo/coreserver",
	        '$BUILD_DIR/mongo/db/index/index_descriptor',
	        '$BUILD_DIR/mongo/db/storage/index_entry_comparison',
	        '$BUILD_DIR/mongo/db/storage/sorted_data_interface_test_harness',
	        '$BUILD_DIR/mongo/global_environment_experiment',
	        '$BUILD_DIR/mongo/index_names',
	        '$BUILD_DIR/mongo/serveronly'
	       ],
	       NO_CRUTCH=True
	   )

